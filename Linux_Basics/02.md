# 2. Первые шаги в изучении интерфейса командной строки

## Содержание

+ [2.1 Страницы руководств man](#21-страницы-руководств-man)
+ [2.2 Работа с директориями](#22-работа-с-директориями)
+ [2.3 Работа с файлами](#23-работа-с-файлами)
+ [2.4 Работа с содержимым файлов](#24-работа-с-содержимым-файлов)
+ [2.5 Дерево директорий Linux](#25-дерево-директорий-linux)

[Оглавление](./README.md)

## 2.1 Страницы руководств man

### Глава 5. Страницы руководств man

В данной главе описывается методика использования man-страниц (также называемых страницами руководств) при работе с вашим компьютером под управлением Unix или Linux.

Вы узнаете о том, как использовать команду man, а также такие связанные с ней команды, как whereis, whatis и mandb.

Большинство файлов и утилит в системах Unix имеет отличные страницы руководств с пояснениями относительно их использования. Страницы руководств становятся особенно полезными в тех случаях, когда вы используете множество различных разновидностей систем Unix или несколько дистрибутивов Linux, так как опции и параметры используемых в них приложений иногда отличаются.

### Команда man $команда

Вы можете ввести команду man с последующим именем интересующей команды (для которой вам хотелось бы получить справочную информацию) и начать чтение страницы руководства. Нажмите q для выхода из режима чтения страницы руководства. Некоторые страницы руководств содержат примеры (расположенные ближе к концу страницы).

```sh
paul@laika:~$ man whois
Форматирование страницы whois(1), подождите...
```

### Команда man $имя_файла_конфигурации

Для большинства файлов конфигурации имеются отдельные страницы руководств.

```sh
paul@laika:~$ man syslog.conf
Форматирование страницы syslog.conf(5), подождите...
```

### Команда man $демон

Также данное утверждение справедливо для большинства демонов (программ, работающих в фоновом режиме) из вашей системы.

```sh
paul@laika:~$ man syslogd
Форматирование страницы syslogd(8), подождите...
```

### Команда man -k (apropos)

Команда man -k (или apropos) позволяет вывести список страниц руководств, содержащих заданную строку.

```sh
paul@laika:~$ man -k syslog
lm-syslog-setup (8)  - configure laptop mode to switch syslog.conf ...
logger (1)           - a shell command interface to the syslog(3) ...
syslog-facility (8)  - Setup and remove LOCALx facility for sysklogd
syslog.conf (5)      - syslogd(8) configuration file
syslogd (8)          - Linux system logging utilities.
syslogd-listfiles (8) - list system logfiles
```

### Команда whatis

Для ознакомления с описанием страницы руководства следует использовать команду whatis с именем интересующей страницы руководства.

```sh
paul@u810:~$ whatis route
route (8)            - show / manipulate the IP routing table
```

### Команда whereis

Расположение файла страницы руководства в рамках файловой системы может быть определено с помощью команды whereis.

```sh
paul@laika:~$ whereis -m whois
whois: /usr/share/man/man1/whois.1.gz
```

Этот файл может быть непосредственно прочитан с помощью команды man.

```sh
paul@laika:~$ man /usr/share/man/man1/whois.1.gz
```

### Номера справочных разделов

Вы, скорее всего, обратили внимание на числа в круглых скобках. Выполнив команду man man, вы можете узнать о том, что эти числа являются номерами справочных разделов. Исполняемые файлы и команды оболочки отнесены к первому справочному разделу.

1. Исполняемые программы или команды оболочки (shell)
2. Системные вызовы (функции, предоставляемые ядром)
3. Библиотечные вызовы (функции, предоставляемые программными библиотеками)
4. Специальные файлы (обычно находящиеся в каталоге /dev)
5. Форматы файлов и соглашения, например о /etc/passwd
6. Игры
7. Разное (включает пакеты макросов и соглашения), например man(7), groff(7)
8. Команды администрирования системы (обычно, запускаемые только суперпользователем)
9. Процедуры ядра [нестандартный раздел]

### Команда man раздел файл

Таким образом, при обращении к странице руководства для команды passwd, вы можете обнаружить, что эта страница обозначается как passwd(1); при обращении к странице руководства для файла passwd используется обозначение passwd(5). Приведенные ниже примеры команд иллюстрируют методику открытия страниц руководств из корректных разделов.

```sh
[paul@RHEL52 ~]$ man passwd      # открывает первую найденную страницу руководства
[paul@RHEL52 ~]$ man 5 passwd    # открывает страницу руководства из раздела 5
```

### Команда man man

Если вы желаете узнать больше о команде man, прочитайте это замечательное руководство (Read The Fantastic Manual - RTFM).

К сожалению, на страницах руководств невозможно найти ответы на все вопросы...

```sh
paul@laika:~$ man woman
Нет справочной страницы для woman
```

### Утилита mandb

Если вы убеждены в том, что страница руководства существует, но при этом вы не можете получить доступ к ней, попробуйте выполнить команду mandb в дистрибутиве Debian/Mint.

```sh
root@laika:~# mandb
В 0 man-подкаталогах содержатся более новые справочные страницы. 
Добавлено 0 справочных страниц. 
Добавлено 0 побочных cat-страниц. 
Вычищено 0 старых записей базы данных.
```

Или команду makewhatis в дистрибутиве CentOS/Redhat.

```sh
[root@centos65 ~]# apropos scsi
scsi: ничего подходящего не найдено.
[root@centos65 ~]# makewhatis 
[root@centos65 ~]# apropos scsi
hpsa                 (4)  - HP Smart Array SCSI driver
lsscsi               (8)  - list SCSI devices (or hosts) and their attributes
sd                   (4)  - Driver for SCSI Disk Drives
st                   (4)  - SCSI tape device
```

---
[Содержание](#содержание)

## 2.2 Работа с директориями

### Глава 6. Работа с директориями

В данной главе приводится краткий обзор большинства стандартных команд, используемых при работе с директориями: pwd, cd, ls, mkdir и rmdir. Эти команды доступны при работе с любой системой Linux (или Unix).

Кроме того, в данной главе обсуждаются понятия абсолютных и относительных путей, а также описывается методика использования механизма завершения путей командной оболочки bash.

### Команда pwd

С помощью команды `pwd` (расшифровывается как Print Working Directory - вывести информацию о рабочей директории) может быть получена информация о вашем текущем местонахождении в рамках файловой системы. Попробуйте выполнить эту команду: получите доступ к интерфейсу командной строки системы (воспользовавшись одним из приложений со следующими названиями: terminal, console или xterm) и введите команду pwd. Командная оболочка выведет путь к вашей текущей директории.

```sh
paul@debian8:~$ pwd
/home/paul
```

### Команда cd

Вы можете изменить вашу текущую директорию с помощью команды cd (расшифровывается как Change Directory - изменить директорию).

```sh
paul@debian8$ cd /etc
paul@debian8$ pwd
/etc
paul@debian8$ cd /bin
paul@debian8$ pwd
/bin
paul@debian8$ cd /home/paul/
paul@debian8$ pwd
/home/paul
```

### Команда `cd ~`

Команда cd также может использоваться для быстрого перехода назад в вашу домашнюю директорию. Простое исполнение команды `cd` без задания пути к целевой директории приведет к перемещению в домашнюю директорию. Исполнение команды `cd ~` приведет к аналогичному эффекту.

```sh
paul@debian8$ cd /etc
paul@debian8$ pwd
/etc
paul@debian8$ cd
paul@debian8$ pwd
/home/paul
paul@debian8$ cd ~
paul@debian8$ pwd
/home/paul
```

### Команда `cd ..`

Для перехода в родительскую директорию (ту директорию, которая находится над вашей текущей директорией в дереве директорий) следует использовать команду `cd ..` .

```sh
paul@debian8$ pwd
/usr/share/games
paul@debian8$ cd ..
paul@debian8$ pwd
/usr/share
```

Для того, чтобы остаться в текущей директории, просто введите команду cd . 🙂 Позднее мы все же познакомимся с практическим примером использования символа ., представляющего текущую директорию.

### Команда `cd -`

Другой полезный вариант использования команды `cd` заключается в выполнении простой команды `cd -` для перехода в предыдущую директорию.

```sh
paul@debian8$ pwd
/home/paul
paul@debian8$ cd /etc
paul@debian8$ pwd
/etc
paul@debian8$ cd -
/home/paul
paul@debian8$ cd -
/etc
```

### Абсолютные и относительные пути

Вы должны иметь представление об абсолютных и относительных путях в рамках дерева директорий файловой системы. Если вы вводите путь, начинающийся с символа слэша (/), подразумевается, что путь будет указан относительно корневой директории файловой системы. Если же вы не начинаете ввод пути с символа слэша, подразумевается, что точкой отсчета будет текущая директория.

В примере ниже показано, что текущей директорией является директория /home/paul. Для перехода из этой директории в директорию /home вам придется ввести команду cd /home вместо команды cd home.

```sh
paul@debian8$ pwd
/home/paul
paul@debian8$ cd home
bash: cd: home: Нет такого файла или каталога
paul@debian8$ cd /home
paul@debian8$ pwd
/home
```

При нахождении в директории /home вам придется ввести команду cd paul вместо команды cd /paul для перехода в поддиректорию paul текущей директории /home.

```sh
paul@debian8$ pwd
/home
paul@debian8$ cd /paul
bash: cd: /paul: Нет такого файла или каталога
paul@debian8$ cd paul
paul@debian8$ pwd
/home/paul
```

В том же случае, если вашей текущей директорией является корневая директория /, то и команда cd /home, и команда cd home позволят вам переместиться в директорию /home.

```sh
paul@debian8$ pwd
/
paul@debian8$ cd home
paul@debian8$ pwd
/home
paul@debian8$ cd /
paul@debian8$ cd /home
paul@debian8$ pwd
/home
```

Этот пример был последним примером, в котором используются команды pwd. С этого момента информация о текущей директории будет всегда выводиться в рамках приглашения командной оболочки. Далее в данной книге будут даны пояснения относительно того, как следует использовать переменную командной оболочки $PS1 для вывода описанной информации.

### Завершение путей

Клавиша TAB может помочь избежать ошибок при вводе путей. Нажатие клавиши TAB после ввода части команды cd /et приведет к завершению команды до вида cd /etc/. При этом нажатие клавиши TAB после ввода команды cd /Et не приведет ни к чему, так как была допущена ошибка при вводе части пути (использована буква E в верхнем регистре).

Вам придется нажимать меньше клавиш в случае использования клавиши TAB, к тому же, при использовании этой клавиши вы можете быть уверены в том, что введенный путь является корректным!

### Утилита ls

Вы можете вывести список содержимого директории с помощью утилиты `ls`.

```sh
paul@debian8:~$ ls
allfiles.txt  dmesg.txt  services   stuff  summer.txt
paul@debian8:~$
```

### Команда `ls -a`

Часто используемым параметром утилиты ls является параметр -a, который предназначен для вывода информации обо всех файлах. Под выводом информации обо всех файлах подразумевается вывод информации в том числе и о скрытых файлах. В том случае, если имя файла в рамках файловой системы Linux начинается с символа точки, он считается скрытым файлом и не включается в обычные списки содержимого директорий.

```sh
paul@debian8:~$ ls
allfiles.txt  dmesg.txt  services  stuff  summer.txt
paul@debian8:~$ ls -a
.   allfiles.txt   .bash_profile  dmesg.txt   .lesshst  stuff
..  .bash_history  .bashrc        services    .ssh      summer.txt 
paul@debian8:~$
```

### Команда `ls -l`

Вам придется многократно использовать параметры утилиты ls для вывода информации о содержимом директории в различных форматах или для вывода информации о различных файлах из директории. Команда ls без параметров позволяет получить список файлов, расположенных в директории. Команда ls -l (в качестве параметра использована строчная буква L, а не число 1) позволяет получить более подробный список файлов.

```sh
paul@debian8:~$ ls -l
итого 17296
-rw-r--r-- 1 paul paul 17584442 сен 17 00:03 allfiles.txt
-rw-r--r-- 1 paul paul    96650 сен 17 00:03 dmesg.txt
-rw-r--r-- 1 paul paul    19558 сен 17 00:04 services
drwxr-xr-x 2 paul paul     4096 сен 17 00:04 stuff
-rw-r--r-- 1 paul paul        0 сен 17 00:04 summer.txt
```

### Команда `ls -lh`

Другим периодически используемым параметром утилиты ls является параметр -h. Он позволяет выводить числовые значения (соответствующие размерам файлов) в формате, лучше читаемом человеком. Также в примере ниже показаны варианты передачи параметров утилите ls. Позднее в данной книге будут даны подробные пояснения относительно выводимых данных.

Обратите внимание на то, что мы используем строчную букву L, а не число 1 в качестве параметра утилиты в данном примере

```sh
paul@debian8:~$ ls -l -h
итого 17M
-rw-r--r-- 1 paul paul  17M сен 17 00:03 allfiles.txt
-rw-r--r-- 1 paul paul  95K сен 17 00:03 dmesg.txt
-rw-r--r-- 1 paul paul  20K сен 17 00:04 services
drwxr-xr-x 2 paul paul 4.0K сен 17 00:04 stuff
-rw-r--r-- 1 paul paul    0 сен 17 00:04 summer.txt
paul@debian8:~$ ls -lh
итого 17M
-rw-r--r-- 1 paul paul  17M сен 17 00:03 allfiles.txt
-rw-r--r-- 1 paul paul  95K сен 17 00:03 dmesg.txt
-rw-r--r-- 1 paul paul  20K сен 17 00:04 services
drwxr-xr-x 2 paul paul 4.0K сен 17 00:04 stuff
-rw-r--r-- 1 paul paul    0 сен 17 00:04 summer.txt
paul@debian8:~$ ls -hl
итого 17M
-rw-r--r-- 1 paul paul  17M сен 17 00:03 allfiles.txt
-rw-r--r-- 1 paul paul  95K сен 17 00:03 dmesg.txt
-rw-r--r-- 1 paul paul  20K сен 17 00:04 services
drwxr-xr-x 2 paul paul 4.0K сен 17 00:04 stuff
-rw-r--r-- 1 paul paul    0 сен 17 00:04 summer.txt
paul@debian8:~$ ls -h -l
итого 17M
-rw-r--r-- 1 paul paul  17M сен 17 00:03 allfiles.txt
-rw-r--r-- 1 paul paul  95K сен 17 00:03 dmesg.txt
-rw-r--r-- 1 paul paul  20K сен 17 00:04 services
drwxr-xr-x 2 paul paul 4.0K сен 17 00:04 stuff
-rw-r--r-- 1 paul paul    0 Sep 17 00:04 summer.txt
paul@debian8:~$
```

### Утилита mkdir

Обход дерева директорий файловой системы Unix является интересным занятием, но еще больший интерес представляет создание ваших собственных директорий с помощью утилиты mkdir. Вам придется передавать как минимум один параметр утилите mkdir, а именно, имя новой директории, которая должна быть создана. При этом следует серьезно задумываться перед использованием начального символа / в именах директорий.

```sh
paul@debian8:~$ mkdir mydir
paul@debian8:~$ cd mydir
paul@debian8:~/mydir$ ls -al
итого 8
drwxr-xr-x  2 paul paul 4096 сен 17 00:07 .
drwxr-xr-x 48 paul paul 4096 сен 17 00:07 ..
paul@debian8:~/mydir$ mkdir stuff
paul@debian8:~/mydir$ mkdir otherstuff
paul@debian8:~/mydir$ ls -l
итого 8
drwxr-xr-x 2 paul paul 4096 сен 17 00:08 otherstuff
drwxr-xr-x 2 paul paul 4096 сен 17 00:08 stuff
paul@debian8:~/mydir$
```

### Команда `mkdir -p`

Исполнение следующей команды закончится неудачей, так как родительской директории для директории threedirsdeep не существует.

```sh
paul@debian8:~$ mkdir mydir2/mysubdir2/threedirsdeep
mkdir: невозможно создать каталог "mydir2/mysubdir2/threedirsdeep": Нет такого файла или каталога
```

В случае использования параметра -p утилиты mkdir при необходимости будут создаваться родительские директории.

```sh
paul@debian8:~$ mkdir -p mydir2/mysubdir2/threedirsdeep
paul@debian8:~$ cd mydir2
paul@debian8:~/mydir2$ ls -l
итого 4
drwxr-xr-x 3 paul paul 4096 сен 17 00:11 mysubdir2
paul@debian8:~/mydir2$ cd mysubdir2
paul@debian8:~/mydir2/mysubdir2$ ls -l
итого 4
drwxr-xr-x 2 paul paul 4096 сен 17 00:11 threedirsdeep
paul@debian8:~/mydir2/mysubdir2$ cd threedirsdeep/
paul@debian8:~/mydir2/mysubdir2/threedirsdeep$ pwd
/home/paul/mydir2/mysubdir2/threedirsdeep
```

### Утилита rmdir

В том случае, если директория пуста, вы можете использовать утилиту rmdir для удаления этой директории.

```sh
paul@debian8:~/mydir$ ls -l
итого 8
drwxr-xr-x 2 paul paul 4096 сен 17 00:08 otherstuff
drwxr-xr-x 2 paul paul 4096 сен 17 00:08 stuff
paul@debian8:~/mydir$ rmdir otherstuff
paul@debian8:~/mydir$ cd ..
paul@debian8:~$ rmdir mydir
rmdir: не удалось удалить "mydir": Каталог не пуст
paul@debian8:~$ rmdir mydir/stuff
paul@debian8:~$ rmdir mydir
paul@debian8:~$
```

### Команда `rmdir -p`

И по аналогии с параметром mkdir -p, вы также можете использовать утилиту rmdir для рекурсивного удаления директорий.

```sh
paul@debian8:~$ mkdir -p test42/subdir
paul@debian8:~$ rmdir -p test42/subdir
paul@debian8:~$
```

---
[Содержание](#содержание)

## 2.3 Работа с файлами

### Глава 7. Работа с файлами

Из данной главы вы узнаете о том, как определять тип файлов, создавать, удалять, копировать и перемещать файлы с помощью таких утилит, как `file`, `touch`, `rm`, `cp`, `mv` и `rename`.

### Все имена файлов регистрозависимы

Имена файлов в Linux (или в любой системе Unix) являются регистрозависимыми. Это означает, что имена FILE1 и file1 не являются равноценными, а путь к файлу /etc/hosts отличен от пути к файлу /etc/Hosts (последнего файла не должно существовать в файловой системе типичного компьютера, работающего под управлением Linux).

В данном примере продемонстрировано различие между двумя файлами, причем имя первого файла начинается с заглавной буквы W, а второго - с прописной буквы w.

```sh
paul@laika:~/Linux$ ls
winter.txt  Winter.txt
paul@laika:~/Linux$ cat winter.txt
Холодно.
paul@laika:~/Linux$ cat Winter.txt
Очень холодно!
```

### Все является файлом

Любая директория на самом деле является файлом (с регистрозависмым именем!), хотя этот файл и имеет специальный тип. Каждый терминал (например, /dev/pts/4), любой жесткий диск или раздел на нем (например, /dev/sdb1) и любой процесс представлены где-либо в рамках файловой системы с помощью файла. После изучения данной главы у вас не останется сомнений в том, что в Linux все является файлом.

### Утилита file

Утилита file предназначена для определения типа файла. В Linux для определения типов файлов не используются их расширения. Для инструментов с интерфейсом командной строки абсолютно безразлично, оканчивается ли имя файла на .txt или на .pdf. Исполняя обязанности системного администратора, вы должны использовать команду file для установления типа интересующего вас файла. Ниже приведено несколько примеров использования данной утилиты при работе с типичной системой Linux.

```sh
paul@laika:~$ file pic33.png
pic33.png: PNG image data, 3840 x 1200, 8-bit/color RGBA, non-interlaced
paul@laika:~$ file /etc/passwd
/etc/passwd: ASCII text
paul@laika:~$ file HelloWorld.c
HelloWorld.c: ASCII C program text
```

Утилита file использует файл со списком "магических последовательностей байт", содержащий шаблоны для распознавания типов данных. Файл со списком "магических последовательностей байт" расположен по пути /usr/share/file/magic. Используйте команду man 5 magic в случае необходимости получения дополнительной информации о нем.

Важно отметить, что для работы с такими специальными файлами, как файлы из директорий /dev и /proc, следует использовать команду `file -s`.

```sh
root@debian6~# file /dev/sda
/dev/sda: block special
root@debian6~# file -s /dev/sda
/dev/sda: x86 boot sector; partition 1: ID=0x83, active, starthead...
root@debian6~# file /proc/cpuinfo
/proc/cpuinfo: empty
root@debian6~# file -s /proc/cpuinfo
/proc/cpuinfo: ASCII C++ program text
```

### Утилита touch

#### Создание пустого файла

Один из простых способов создания пустого файла заключается в использовании утилиты touch. (Позднее в данной книге мы рассмотрим множество других способов создания файлов.)

Данный пример начинается с открытия пустой директории, в которой с помощью утилиты touch создаются два файла, после чего выводится список созданных файлов.

```sh
paul@debian7:~$ ls -l
итого 0
paul@debian7:~$ touch file42
paul@debian7:~$ touch file33
paul@debian7:~$ ls -l
итого 0
-rw-r--r-- 1 paul paul 0 окт 15 08:57 file33
-rw-r--r-- 1 paul paul 0 окт 15 08:56 file42
paul@debian7:~$
```

#### Команда touch -t

Утилита touch позволяет устанавливать набор значений свойств пустых файлов в процессе их создания. Удастся ли вам определить, какие значения свойств были установлены, ознакомившись с приведенным ниже примером? Если вы не смогли разобраться самостоятельно, обратитесь к странице руководства для утилиты touch.

```sh
paul@debian7:~$ touch -t 200505050000 SinkoDeMayo
paul@debian7:~$ touch -t 130207111630 BigBattle.txt
paul@debian7:~$ ls -l
total 0
-rw-r--r-- 1 paul paul 0 июл 11  1302 BigBattle.txt
-rw-r--r-- 1 paul paul 0 окт 15 08:57 file33
-rw-r--r-- 1 paul paul 0 окт 15 08:56 file42
-rw-r--r-- 1 paul paul 0 май  5  2005 SinkoDeMayo
paul@debian7:~$
```

### rm

#### Удаление файлов навсегда

В том случае, если вам больше не нужен файл, следует использовать утилиту rm для его удаления. В отличие от некоторых графических пользовательских интерфейсов, интерфейс командной строки системы не предполагает использования таких хранилищ файлов, как корзина, предназначенных для последующего восстановления удаленных файлов. Если вы удалили файл с помощью утилиты rm, этот файл будет удален навсегда. Исходя из этого, следует проявлять осторожность при удалении файлов!

```sh
paul@debian7:~$ ls
BigBattle.txt  file33  file42  SinkoDeMayo
paul@debian7:~$ rm BigBattle.txt
paul@debian7:~$ ls
file33  file42  SinkoDeMayo
paul@debian7:~$
```

#### Команда rm -i

Для того, чтобы застраховаться от случайного удаления файла, вы можете использовать команду rm -i.

```sh
paul@debian7:~$ ls
file33  file42  SinkoDeMayo
paul@debian7:~$ rm -i file33
rm: удалить пустой обычный файл "file33"? yes
paul@debian7:~$ rm -i SinkoDeMayo
rm: удалить пустой обычный файл "SinkoDeMayo"? n
paul@debian7:~$ ls
file42  SinkoDeMayo
paul@debian7:~$
```

#### Команда rm -rf

По умолчанию с помощью команды rm -r невозможно удалить непустые директории. Однако, утилита rm принимает параметры, которые позволят вам удалять любую директорию. Команда rm -rf известна благодаря тому, что она позволяет удалять все элементы файловой системы (конечно же, в том случае, если вы имеете достаточные права для выполнения этой операции). В том случае, если вы вошли в систему, воспользовавшись учетной записью пользователя root, следует проявить особую осторожность при использовании команды rm -rf (параметр f расшифровывается как force (принудительное выполнение операции), а параметр r - как recursive (рекурсивный обход директорий)), так как в случае работы с учетной записью пользователя root, упомянутые ограничения прав не будут распространяться на вас. Вы сможете в буквальном смысле удалить все файлы вашей системы по неосторожности.

```sh
paul@debian7:~$ mkdir test
paul@debian7:~$ rm test
rm: невозможно удалить "test": Это каталог
paul@debian7:~$ rm -rf test
paul@debian7:~$ ls test
ls: невозможно получить доступ к test: Нет такого файла или каталога
paul@debian7:~$
```

### Утилита cp

#### Копирование отдельных файлов

Для копирования файла следует использовать утилиту cp с аргументами, представленными путями к исходному и целевому файлам.

```sh
paul@debian7:~$ ls
file42  SinkoDeMayo
paul@debian7:~$ cp file42 file42.copy
paul@debian7:~$ ls
file42  file42.copy  SinkoDeMayo
```

#### Копирование файлов в другую директорию

В том случае, если в качестве пути к целевому файлу используется путь к директории, исходные файлы будут скопированы в эту целевую директорию.

```sh
paul@debian7:~$ mkdir dir42
paul@debian7:~$ cp SinkoDeMayo dir42
paul@debian7:~$ ls dir42/
SinkoDeMayo
```

#### Команда cp -r

Для копирования директорий целиком следует использовать команду cp -r (параметр -r позволяет осуществлять рекурсивное копирование всех файлов из всех поддиректорий).

```sh
paul@debian7:~$ ls
dir42  file42  file42.copy  SinkoDeMayo
paul@debian7:~$ cp -r dir42/ dir33
paul@debian7:~$ ls
dir33  dir42  file42  file42.copy  SinkoDeMayo
paul@debian7:~$ ls dir33/
SinkoDeMayo
```

#### Копирование множества файлов в директорию

Вы также можете использовать утилиту cp для копирования множества файлов в одну директорию. В этом случае последний аргумент (аргумент, указывающий на цель) должен быть представлен путем к директории.

```sh
paul@debian7:~$ cp file42 file42.copy SinkoDeMayo dir42/
paul@debian7:~$ ls dir42/
file42  file42.copy  SinkoDeMayo
```

#### Команда cp -i

Для предотвращения перезаписи существующих файлов в ходе использования утилиты cp следует использовать параметр -i (для активации интерактивного режима копирования).

```sh
paul@debian7:~$ cp SinkoDeMayo file42
paul@debian7:~$ cp SinkoDeMayo file42
paul@debian7:~$ cp -i SinkoDeMayo file42
cp: переписать "file42"? n
paul@debian7:~$
```

### Утилита mv

#### Переименование файлов с помощью утилиты mv

Утилита mv используется для переименования файлов или для перемещения файлов в другие директории.

```sh
paul@debian7:~$ ls
dir33  dir42  file42  file42.copy  SinkoDeMayo
paul@debian7:~$ mv file42 file33
paul@debian7:~$ ls
dir33  dir42  file33  file42.copy  SinkoDeMayo
paul@debian7:~$
```

В том случае, если вам необходимо переименовать один файл, утилита mv является предпочтительным инструментом.

#### Переименование директорий с помощью утилиты mv

Эта же утилита mv может быть использована и для переименования директорий.

```sh
paul@debian7:~$ ls -l
итого 8
drwxr-xr-x 2 paul paul 4096 окт 15 09:36 dir33
drwxr-xr-x 2 paul paul 4096 окт 15 09:36 dir42
-rw-r--r-- 1 paul paul    0 окт 15 09:38 file33
-rw-r--r-- 1 paul paul    0 окт 15 09:16 file42.copy
-rw-r--r-- 1 paul paul    0 май  5  2005 SinkoDeMayo
paul@debian7:~$ mv dir33 backup
paul@debian7:~$ ls -l
итого 8
drwxr-xr-x 2 paul paul 4096 окт 15 09:36 backup
drwxr-xr-x 2 paul paul 4096 окт 15 09:36 dir42
-rw-r--r-- 1 paul paul    0 окт 15 09:38 file33
-rw-r--r-- 1 paul paul    0 окт 15 09:16 file42.copy
-rw-r--r-- 1 paul paul    0 май  5  2005 SinkoDeMayo
paul@debian7:~$
```

#### Команда mv -i

Утилита mv поддерживает параметр -i по аналогии с утилитами cp и rm.

В примере ниже показано, как при использовании команды mv -i запрашивается подтверждение перезаписи существующего файла.

```sh
paul@debian7:~$ mv -i file33 SinkoDeMayo
mv: переписать "SinkoDeMayo"? no
paul@debian7:~$
```

### Утилита rename

#### Об утилите rename

Утилита rename является одним из редких случаев, когда в рамках книги "Фундаментальные основы Linux" приходится делать разделение между дистрибутивами Linux. Практически каждая из описанных в данной книге утилит работает практически на каждом компьютере под управлением Linux. Но реализации утилиты rename в различных дистрибутивах отличаются.

Следует пытаться использовать утилиту mv всегда, когда вам необходимо переименовать несколько файлов.

#### Утилита rename в дистрибутиве Debian/Ubuntu

Утилита rename в дистрибутиве Debian имеет сложный синтаксис (используются регулярные выражения) для единовременного переименования множества файлов.

Ниже приведен пример использования утилиты rename, с помощью которой у всех файлов с расширением .txt производится замена расширения на .png.

```sh
paul@debian7:~/test42$ ls
abc.txt  file33.txt  file42.txt
paul@debian7:~/test42$ rename 's/\.txt/\.png/' *.txt
paul@debian7:~/test42$ ls
abc.png  file33.png  file42.png
```

Во втором примере производится замена всех (первых) вхождений слов "file" на "document" во всех файлах с расширением .png.

```sh
paul@debian7:~/test42$ ls
abc.png  file33.png  file42.png
paul@debian7:~/test42$ rename 's/file/document/' *.png
paul@debian7:~/test42$ ls
abc.png  document33.png  document42.png
paul@debian7:~/test42$
```

#### Утилита rename в дистрибутиве CentOS/RHEL/Fedora

В Red Hat Enterprise Linux синтаксис утилиты rename немного отличается. В первом примере, представленном ниже, осуществляется переименование всех файлов с расширением .conf (*.conf) путем замены всех вхождений .conf на .backup.

```sh
[paul@centos7 ~]$ touch one.conf two.conf three.conf
[paul@centos7 ~]$ rename .conf .backup *.conf
[paul@centos7 ~]$ ls
one.backup  three.backup  two.backup
[paul@centos7 ~]$
```

Во втором примере производится переименование всех файлов (*) путем замены всех вхождений one на ONE.

```sh
[paul@centos7 ~]$ ls
one.backup  three.backup  two.backup
[paul@centos7 ~]$ rename one ONE *
[paul@centos7 ~]$ ls
ONE.backup  three.backup  two.backup
[paul@centos7 ~]$
```

---
[Содержание](#содержание)

## 2.4 Работа с содержимым файлов

### Глава 8. Работа с содержимым файлов

В данной главе мы будем работать с содержимым текстовых файлов, используя утилиты `head`, `tail`, `cat`, `tac`, `more`, `less` и `strings`.

Также мы познакомимся с возможностями таких инструментов с интерфейсом командной строки, как `cat`.

### Утилита head

Вы можете использовать утилиту head для вывода первых десяти строк файла.

```sh
paul@laika:~$ head /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
paul@laika:~$
```

Утилита `head` также может использоваться для вывода первых n строк файла.

```sh
paul@laika:~$ head -4 /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
```

Кроме того, утилита head может использоваться для вывода первых n байт файла.

```sh
paul@laika:~$ head -c4 /etc/passwd
rootpaul@laika:~$
```

### Утилита tail

По аналогии с утилитой head, утилита tail может использоваться для вывода последних десяти строк файла.

```sh
paul@laika:~$ tail /etc/services 
vboxd           20012/udp
binkp           24554/tcp             # binkp fidonet protocol
asp             27374/tcp             # Address Search Protocol
asp             27374/udp
csync2          30865/tcp             # cluster synchronization tool
dircproxy       57000/tcp             # Detachable IRC Proxy
tfido           60177/tcp             # fidonet EMSI over telnet
fido            60179/tcp             # fidonet EMSI over TCP

# Local services
paul@laika:~$
```

Вы можете передать утилите tail число, соответствующее количеству строк, которое вы хотите увидеть в выводе.

```sh
$ tail -3 count.txt 
шесть
семь
восемь
```

Утилита tail поддерживает и другие полезные параметры, причем некоторые из них мы будем использовать в рамках данного курса.

### Утилита cat

Утилита cat является одним из наиболее универсальных инструментов операционной системы. Все, что она делает - это копирует данные из стандартного потока ввода в стандартный поток вывода. Данная утилита в комбинации с командной оболочкой позволяет реализовать мощные и разнообразные механизмы обработки данных. Воспользуемся примерами для иллюстрации этих механизмов. Первый пример является достаточно простым и вы можете использовать рассмотренную в нем команду в повседневной работе для вывода содержимого файла на экран. В том случае, если данные из файла не умещаются на экране, будет осуществлена прокрутка до конца файла.

```sh
paul@laika:~$ cat /etc/resolv.conf
nameserver 194.7.1.4
paul@laika:~$
```

#### Объединение файлов

Имя утилиты cat является сокращенной формой слова concatenate (объединить). Одним из наиболее простых сценариев использования данной утилиты является объединение файлов в рамках файла большего объема (или полного файла).

```sh
paul@laika:~$ echo один > part1
paul@laika:~$ echo два > part2
paul@laika:~$ echo три > part3
paul@laika:~$ cat part1 part2 part3
один
два
три
paul@laika:~$
```

#### Создание файлов

Также вы можете использовать утилиту `cat` для создания текстовых файлов. Введите команду `cat > winter.txt`, приведенную в примере ниже. После этого введите одну строку или несколько строк текста, завершая ввод каждой из строк нажатием клавиши `Enter`. После ввода последней строки текста нажмите и удерживайте клавишу `Ctrl` и одновременно с этим кратковременно нажмите клавишу `d`.

```sh
paul@laika:~/test$ cat > winter.txt
Сегодня очень холодно!
paul@laika:~/test$ cat winter.txt 
Сегодня очень холодно!
paul@laika:~/test$
```

Комбинация клавиш `Ctrl+d` позволяет передать исполняющемуся процессу символ окончания файла (`End of File - EOF`), что приведет к завершению исполнения процесса `cat`.

#### Специальный маркер окончания файла

Вы можете установить специальный маркер окончания файла для утилиты `cat` с помощью параметра `<<` таким образом, как показано в примере. Данная конструкция называется локальной директивой (`here directive`) и позволяет завершать работу процесса `cat`.

```sh
paul@laika:~/test$ cat > hot.txt <<stop
> Сегодня жарко!
> Да, это лето.
> stop
paul@laika:~/test$ cat hot.txt 
Сегодня жарко!
Да, это лето.
paul@laika:~/test$
```

#### Копирование файлов

При рассмотрении третьего примера вы можете обнаружить, что утилита `cat` также может использоваться для копирования файлов. Подробные пояснения относительно происходящих в этом случае процессов будут даны в главе, посвященной командной оболочке `bash`.

```sh
paul@laika:~/test$ cat winter.txt 
Сегодня очень холодно!
paul@laika:~/test$ cat winter.txt > cold.txt
paul@laika:~/test$ cat cold.txt 
Сегодня очень холодно!
paul@laika:~/test$
```

### Утилита tac

Предназначение утилиты `tac` (в отличие от утилиты `cat`) может быть проиллюстрировано с помощью единственного примера.

```sh
paul@laika:~/test$ cat count 
один
два
три
четыре
paul@laika:~/test$ tac count 
четыре
три
два
один
paul@laika:~/test$
```

### Утилиты more и less

Утилита more может оказаться полезной в случае возникновения необходимости вывода содержимого файлов, которое не умещается на экране. Утилита `more` позволяет ознакомится с содержимым файла, разделенным на страницы. После открытия файла с использованием данной утилиты следует использовать клавишу "пробел" для перехода к следующей странице или клавишу `q` для выхода из режима просмотра содержимого файла. Некоторые пользователи предпочитают использовать утилиту `less` вместо утилиты `more`.

### Утилита strings

С помощью утилиты `strings` вы можете осуществить вывод читаемых человеком `ascii`-строк, которые обнаруживаются в бинарных файлах. В приведенном ниже примере выясняется путь к бинарному файлу `ls`, после чего осуществляется вывод читаемых пользователем строк из этого бинарного файла (вывод сокращен).

```sh
paul@laika:~$ which ls
/bin/ls
paul@laika:~$ strings /bin/ls
/lib/ld-linux.so.2
librt.so.1
__gmon_start__
_Jv_RegisterClasses
clock_gettime
libacl.so.1
...
```

---
[Содержание](#содержание)

## 2.5 Дерево директорий Linux

### Глава 9. Дерево директорий Linux

В рамках данной главы производится обзор наиболее часто используемых директорий из дерева директорий файловой системы Linux. Также данная глава может служить доказательством утверждения о том, что в Unix-системе все является файлом.

### Стандарт иерархии файловой системы

Многие дистрибутивы Linux частично следуют Стандарту иерархии файловой системы (Filesystem Hierarchy Standard). Данный стандарт может оказаться полезным для будущего процесса стандартизации деревьев директорий файловых систем Unix/Linux. Стандарт FHS доступен в сети [по адресу](http://www.pathname.com/fhs/), причем на данном ресурсе мы можем прочитать: "Стандарт иерархии файловой системы был создан с целью его использования разработчиками дистрибутивов Unix, разработчиками пакетов для распространения программного обеспечения и разработчиками операционных систем. Однако, данный стандарт является в большей степени справочным материалом, нежели руководством по работе с файловой системой Unix или с иерархиями директорий."

### Страница руководства man hier

Существуют некоторые различия в иерархиях файловых систем различных дистрибутивов Linux. Для того, чтобы ознакомиться с информацией об иерархии файловой системы вашей машины, используйте команду `man hier`. На данной странице руководства будут приведены пояснения относительно структуры дерева директорий системы, установленной на вашем компьютере.

### Корневая директория `/`

Структуры директорий всех систем Linux начинаются с корневой директории. Корневая директория обозначается с помощью символа прямого слэша, а именно, `/`. Все файлы, которые существуют в вашей системе Linux, находится ниже данной корневой директории в дереве директорий. Давайте рассмотрим содержимое этой корневой директории.

```sh
[paul@RHELv4u3 ~]$ ls /
bin   dev  home  media  mnt  proc  sbin     srv  tftpboot  usr
boot  etc  lib   misc   opt  root  selinux  sys  tmp       var
```

### Директории для хранения бинарных файлов

Бинарные файлы являются файлами, содержащими скомпилированный исходный код (или машинный код). Бинарные файлы могут исполняться на компьютере. Иногда бинарные файлы также называются исполняемыми файлами.

#### Директория /bin

Директория `/bin` содержит бинарные файлы, которые могут использоваться всеми пользователями. В соответствии со спецификацией FHS, директория `/bin` должна содержать исполняемые файлы `/bin/cat` и `/bin/date` (помимо других исполняемых файлов).

В примере ниже вы можете увидеть список исполняемых файлов, являющихся реализациями таких команд, как `cat`, `cp`, `cpio`, `date`, `dd`, `echo`, `grep` и.т.д. Многие из упомянутых команд будут рассмотрены в рамках данной книги.

```sh
paul@laika:~$ ls /bin
archdetect       egrep             mt               setupcon
autopartition    false             mt-gnu           sh
bash             fgconsole         mv               sh.distrib
bunzip2          fgrep             nano             sleep
bzcat            fuser             nc               stralign
bzcmp            fusermount        nc.traditional   stty
bzdiff           get_mountoptions  netcat           su
bzegrep          grep              netstat          sync
bzexe            gunzip            ntfs-3g          sysfs
bzfgrep          gzexe             ntfs-3g.probe    tailf
bzgrep           gzip              parted_devices   tar
bzip2            hostname          parted_server    tempfile
bzip2recover     hw-detect         partman          touch
bzless           ip                partman-commit   true
bzmore           kbd_mode          perform_recipe   ulockmgr
cat              kill              pidof            umount
...
```

#### Другие директории `/bin`

Вы можете обнаружить поддиректорию `/bin` во многих других директориях. Например, пользователь с именем `serena` может разместить свои собственные приложения в поддиректории `/home/serena/bin`.

Файлы некоторых приложений, обычно в случае установки путем непосредственной сборки из исходного кода, устанавливаются в директорию `/opt`. К примеру, при установке сервера `samba` для хранения бинарных файлов может быть использована поддиректория `/opt/samba/bin`.

#### Директория `/sbin`

Директория `/sbin` содержит бинарные файлы, предназначенные для настройки операционной системы. Многие из бинарных файлов для настройки системы требуют наличия привилегий пользователя `root` для выполнения определенных задач.

В примере ниже приведен список бинарных файлов для настройки системы, предназначенных для изменения IP-адреса, работы с разделами жестких дисков и создания файловой системы ext4.

```sh
paul@ubu1010:~$ ls -l /sbin/ifconfig /sbin/fdisk /sbin/mkfs.ext4
-rwxr-xr-x 1 root root 97172 2011-02-02 09:56 /sbin/fdisk
-rwxr-xr-x 1 root root 65708 2010-07-02 09:27 /sbin/ifconfig
-rwxr-xr-x 5 root root 55140 2010-08-18 18:01 /sbin/mkfs.ext4
```

#### Директория `/lib`

Бинарные файлы из директорий `/bin` и `/sbin` обычно используют разделяемые библиотеки, расположенные в директории `/lib`. В примере ниже приведен список некоторых файлов из директории `/lib`.

```sh
paul@laika:~$ ls /lib/libc*
/lib/libc-2.5.so     /lib/libcfont.so.0.0.0  /lib/libcom_err.so.2.1    
/lib/libcap.so.1     /lib/libcidn-2.5.so     /lib/libconsole.so.0      
/lib/libcap.so.1.10  /lib/libcidn.so.1       /lib/libconsole.so.0.0.0  
/lib/libcfont.so.0   /lib/libcom_err.so.2    /lib/libcrypt-2.5.so
```

#### Поддиректория `/lib/modules`

Обычно ядро Linux загружает модули из директории `/lib/modules/$версия-ядра/`. Содержимое этой директории будет подробно описано в главе, посвященной ядру Linux.

#### Директории `/lib32` и `/lib64`

На данный момент осуществляется медленная миграция с 32-битных на 64-битные системы. По этой причине вы можете обнаружить в своей системе директории с именами `/lib32` и `/lib64`, которые указывают на размеры регистров, использованные в процессе компиляции расположенных в этих директориях разделяемых библиотек. 64-битный компьютер может содержать некоторые 32-битные бинарные файлы и библиотеки, используемые для достижения совместимости с устаревшими приложениями. В примере ниже утилита `file` используется для демонстрации описанных различий между разделяемыми библиотеками.

```sh
paul@laika:~$ file /lib32/libc-2.5.so 
/lib32/libc-2.5.so: ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), for GNU/Linux 2.6.0, stripped
paul@laika:~$ file /lib64/libcap.so.1.10 
/lib64/libcap.so.1.10: ELF 64-bit LSB shared object, AMD x86-64, version 1 (SYSV), stripped
```

Формат ELF (формат исполняемых и компонуемых файлов - Executable and Linkable Format) используется практически во всех Unix-подобных операционных системах с момента выпуска System V.

#### Директория `/opt`

Директория `/opt` предназначена для хранения вспомогательного программного обеспечения. В большинстве случаев данное программное обеспечение устанавливается не из репозитория дистрибутива. В многих системах директория `/opt` пуста.

При установке пакета программного обеспечения большого объема файлы из него могут копироваться в поддиректории `/bin`, `/lib`, `/etc` директории `/opt/$имя-пакета/`. Например, в том случае, если пакет программного обеспечения носит имя `wp`, файлы из него будут устанавливаться в директорию `/opt/wp`, при этом бинарные файлы будут устанавливаться в поддиректорию `/opt/wp/bin`, а файлы страниц руководств - в поддиректорию `/opt/wp/man`.

### Директории для хранения файлов конфигурации

#### Директория `/boot`

Директория `/boot` содержит все файлы, необходимые для загрузки компьютера. Эти файлы не изменяются очень часто. В системах Linux в данной директории обычно можно обнаружить поддиректорию `/boot/grub`. Директория `/boot/grub` содержит файл `/boot/grub/grub.cfg` (на более старых системах также может использоваться файл `/boot/grub/grub.conf`), в рамках которого описывается меню загрузки, отображаемое перед загрузкой ядра ОС.

#### Директория `/etc`

Все специфичные для машины конфигурационные файлы должны быть расположены в директории `/etc`. Изначально имя директории `/etc` была образовано от слова `etcetera` (и так далее), но сегодня люди часто расшифровывают его как `Editable Text Configuration` (директория с редактируемыми текстовыми файлами конфигурации).

Во многих случаях имена конфигурационных файлов совпадают с именами приложений или протоколов, а в качестве расширений этих файлов используется строка `.conf`.

```sh
paul@laika:~$ ls /etc/*.conf
/etc/adduser.conf        /etc/ld.so.conf       /etc/scrollkeeper.conf
/etc/brltty.conf         /etc/lftp.conf        /etc/sysctl.conf
/etc/ccertificates.conf  /etc/libao.conf       /etc/syslog.conf
/etc/cvs-cron.conf       /etc/logrotate.conf   /etc/ucf.conf
/etc/ddclient.conf       /etc/ltrace.conf      /etc/uniconf.conf
/etc/debconf.conf        /etc/mke2fs.conf      /etc/updatedb.conf
/etc/deluser.conf        /etc/netscsid.conf    /etc/usplash.conf
/etc/fdmount.conf        /etc/nsswitch.conf    /etc/uswsusp.conf
/etc/hdparm.conf         /etc/pam.conf         /etc/vnc.conf
/etc/host.conf           /etc/pnm2ppa.conf     /etc/wodim.conf
/etc/inetd.conf          /etc/povray.conf      /etc/wvdial.conf
/etc/kernel-img.conf     /etc/resolv.conf
paul@laika:~$ 
```

В директории `/etc` также можно обнаружить большое количество других важных файлов.

#### Поддиректория `/etc/init.d/`

Во многих дистрибутивах `Unix/Linux` имеется директория `/etc/init.d`, которая содержит сценарии для запуска и остановки демонов. Эта поддиректория может исчезнуть в процессе перехода дистрибутивов Linux на системы инициализации, которые заменят старую систему инициализации init, используемую для запуска всех демонов.

#### Поддиректория `/etc/X11/`

Управление системой вывода графики осуществляется средствами программного обеспечения от организации `X.org Foundation` (а именно, сервера оконной системы `X Window System` или просто `X`). Файл конфигурации для вашего сервера оконной системы носит имя `/etc/X11/xorg.conf.`

#### Поддиректория `/etc/skel/`

Содержимое директории каркаса `/etc/skel` копируется в домашнюю директорию при создании учетной записи пользователя. Она обычно содержит такие скрытые файлы, как сценарий `.bashrc`.

#### Поддиректория `/etc/sysconfig/`

Данная директория, не упомянутая в спецификации FHS, содержит большое количество файлов конфигурации компонентов дистрибутива Red Hat Enterprise Linux. Впоследствии мы будем более подробно рассматривать некоторые из этих файлов. В примере ниже приведен список файлов директории `/etc/sysconfig` дистрибутива RHELv4u4 в случае установки всех связанных с данной директорией программных компонентов.

```sh
paul@RHELv4u4:~$ ls /etc/sysconfig/
apmd         firstboot     irda              network      saslauthd
apm-scripts  grub          irqbalance        networking   selinux
authconfig   hidd          keyboard          ntpd         spamassassin
autofs       httpd         kudzu             openib.conf  squid
bluetooth    hwconf        lm_sensors        pand         syslog
clock        i18n          mouse             pcmcia       sys-config-sec
console      init          mouse.B           pgsql        sys-config-users
crond        installinfo   named             prelink      sys-logviewer
desktop      ipmi          netdump           rawdevices   tux
diskdump     iptables      netdump_id_dsa    rhn          vncservers
dund         iptables-cfg  netdump_id_dsa.p  samba        xinetd
paul@RHELv4u4:~$
```

Файл `/etc/sysconfig/firstboot` сообщает агенту настройки дистрибутива Red Hat о том, что он не должен запускаться после загрузки системы. В том случае, если вы желаете использовать агент настройки дистрибутива Red Hat после следующей перезагрузки, вам следует просто удалить данный файл и выполнить команду `chkconfig --level 5 firstboot on`. Агент настройки дистрибутива Red Hat позволяет устанавливать последние обновления системы, создавать учетные записи пользователей, пользоваться функциями портала Red Hat Network, а также выполнять другие действия. После запуска он снова создаст файл `/etc/sysconfig/firstboot`.

```sh
paul@RHELv4u4:~$ cat /etc/sysconfig/firstboot 
RUN_FIRSTBOOT=NO
```

Файл `/etc/sysconfig/harddisks` содержит дополнительные параметры настройки жестких дисков. Формат файла описан в самом файле.

Вы можете ознакомиться с описанием программного обеспечения, обнаруженного утилитой `kudzu`, которое сохраняется в файле `/etc/sysconfig/hwconf`. `Kudzu` является приложением от компании Red Hat, предназначенным для автоматического обнаружения и настройки аппаратного обеспечения.

Тип клавиатуры и таблица соответствия символов устанавливаются в файле `/etc/sysconfig/keyboard`. Для получения дополнительной информации о настройках клавиатуры в консоли следует обратиться к следующим страницам руководств `keymaps(5)`, `dumpkeys(1)`, `loadkeys(1)`, а также к содержимому директории `/lib/kbd/keymaps/`.

```sh
root@RHELv4u4:/etc/sysconfig# cat keyboard 
KEYBOARDTYPE="pc"
KEYTABLE="us"
```

Файлы для настройки сетевых устройств из данной директории будут обсуждаться в главе, посвященной настройке сети.

### Директории для хранения данных

#### Директория `/home`

Пользователи могут хранить персональные данные и данные проектов в директории `/home`. Обычно (но не всегда в соответствии со спецификацией FHS) имя домашней директории пользователя устанавливается в соответствии с полным именем пользователя в формате `/home/$имя_пользователя`. Например:

```sh
paul@ubu606:~$ ls /home 
geert  annik  sandra  paul  tom
```

Помимо выделения каждому пользователю (или каждому проекту или группе) места для хранения персональных данных в рамках домашней директории, в рамках этой же директории выделяется место для хранения данных профиля пользователя. Типичный профиль пользователя Unix содержит множество скрытых файлов (файлов, имена которых начинаются с точки). Скрытые файлы пользовательского профиля Unix содержат параметры, установленные для данного пользователя.

```sh
paul@ubu606:~$ ls -d /home/paul/.*
/home/paul/.              /home/paul/.bash_profile  /home/paul/.ssh
/home/paul/..             /home/paul/.bashrc        /home/paul/.viminfo
/home/paul/.bash_history  /home/paul/.lesshst
```

#### Директория `/root`

Во многих системах директория `/root` является стандартной директорией для хранения персональных данных и данных профиля пользователя `root`. В том случае, если ее не существует по умолчанию, администраторы могут создать ее самостоятельно.

#### Директория `/srv`

Вы можете использовать директорию `/srv` для хранения данных, которые обрабатываются вашей системой. Спецификация FHS позволяет хранить в этой директории данные `cvs`, `rsync`, `ftp` и `www`. Кроме того, спецификация FHS подтверждает возможность использования таких административных имен для поддиректорий, как `/srv/project55/ftp` и `/srv/sales/www`.

В системах Sun Solaris (или Oracle Solaris) для этой цели используется директория `/export`.

#### Директория `/media`

Директория `/media` служит точкой монтирования для таких устройств для работы со съемными носителями, как приводы CD-ROM, цифровые камеры, а также различные устройства, подключаемые по шине USB. Так как директория `/media` является достаточно новой в мире систем Unix, вы с высокой вероятностью можете встретить системы, не использующие данную директорию. К примеру, несмотря на то, что система Solaris 9 не имеет рассматриваемой директории, эта директория присутствует в системе Solaris 10. Большинство дистрибутивов Linux на сегодняшний день монтирует все съемные носители в директорию `/media`.

```sh
paul@debian5:~$ ls /media/
cdrom  cdrom0  usbdisk
```

#### Директория `/mnt`

Директория `/mnt` должна быть пустой и использоваться исключительно для создания временных точек монтирования файловых систем (в соответствии со спецификацией FHS).

Администраторы систем Unix и Linux обычно создают в данной директории множество поддиректорий, таких, как `/mnt/something/`. Вы, скорее всего, столкнетесь с системами с более чем одной директорией, созданной и/или смонтированной в рамках директории `/mnt` для работы с различными локальными и удаленными файловыми системами.

#### Директория `/tmp`

Приложения и пользователи должны использовать директорию `/tmp` для хранения временных данных при необходимости. Данные, хранимые в директории `/tmp`, могут в реальности храниться как на диске, так и в оперативной памяти. В обоих случаях обслуживание хранилища временных данных осуществляется средствами операционной системы. Никогда не используйте директорию `/tmp` для хранения данных, которые являются важными или которые вы желаете архивировать.

### Директории в оперативной памяти

#### Директория `/dev`

Файлы устройств из директории `/dev` выглядят как обычные файлы, но на самом деле не являются обычными файлами, размещенными на жестком диске. Директория `/dev` заполняется файлами в процессе определения устройств средствами ядра операционной системы.

#### Стандартные физические устройства

Стандартные устройства, такие, как жесткие диски, представлены файлами устройств в директории /dev. В примере ниже приведен список файлов устройств SATA ноутбука, а также устройств IDE настольного компьютера. (Подробное описание назначения этих файлов устройств будет приведено ниже.)

```sh
#
# Устройства SATA или SCSI или USB
#
paul@laika:~$ ls /dev/sd*
/dev/sda  /dev/sda1  /dev/sda2  /dev/sda3  /dev/sdb  /dev/sdb1  /dev/sdb2

#
# Устройства IDE или ATAPI
#
paul@barry:~$ ls /dev/hd*
/dev/hda  /dev/hda1  /dev/hda2  /dev/hdb  /dev/hdb1  /dev/hdb2  /dev/hdc
```

Помимо представления физических устройств, некоторые файлы устройств выполняют специальные функции. Эти специальные файлы устройств могут оказаться очень полезными.

#### Файлы устройств `/dev/tty` и `/dev/pts`

К примеру, файл устройства `/dev/tty1` представляет терминал или консоль, соединенную с системой. (Не стоит ломать голову над точными значениями терминов 'терминал' или 'консоль', так как в данном случае имеется в виду интерфейс командной строки системы.) При вводе команд в эмуляторе терминала, поставляемом в составе такого графического окружения рабочего стола, как Gnome или KDE, ваш терминал будет представлен файлом устройства `/dev/pts/1` (вместо числа 1 может использоваться другое число).

#### Файл устройства `/dev/null`

В Linux вы можете обнаружить и другие файлы специальных устройств, такие, как файл устройства `/dev/null`, которое может рассматриваться как черная дыра; хотя соответствующее устройство и имеет неограниченную емкость, после записи из него не могут быть прочитаны никакие данные. Говоря техническим языком, любые записанные на представленное файлом `/dev/null` устройство данные будут просто отброшены. Представленное файлом `/dev/null` устройство может быть использовано для отбрасывания ненужного вывода различных команд. Помните о том, что представленное файлом `/dev/null` устройство не является удачным местом для хранения ваших резервных копий данных 🙂.

#### Директория `/proc` и взаимодействие с ядром ОС

Директория `/proc` является другой специальной директорией, которая содержит файлы, кажущиеся на первый взгляд обычными файлами, но не занимающие места на диске. На самом деле содержимое данной директории является представлением ядра ОС, а точнее, используемых ядром ОС структур данных и предназначено для непосредственного взаимодействия с ядром ОС. В директорию `/proc` монтируется специальная файловая система `procfs`.

```sh
paul@RHELv4u4:~$ mount -t proc
none on /proc type proc (rw)
```

При выводе содержимого директории `/proc` можно обнаружить множество директорий с именами, представленными числовыми значениями (в любой системе Unix), а также некоторые интересные файлы (в Linux).

```sh
mul@laika:~$ ls /proc
1      2339   4724  5418  6587  7201       cmdline      mounts
10175  2523   4729  5421  6596  7204       cpuinfo      mtrr
10211  2783   4741  5658  6599  7206       crypto       net
10239  2975   4873  5661  6638  7214       devices      pagetypeinfo
141    29775  4874  5665  6652  7216       diskstats    partitions
15045  29792  4878  5927  6719  7218       dma          sched_debug
1519   2997   4879  6     6736  7223       driver       scsi
1548   3      4881  6032  6737  7224       execdomains  self
1551   30228  4882  6033  6755  7227       fb           slabinfo
1554   3069   5     6145  6762  7260       filesystems  stat
1557   31422  5073  6298  6774  7267       fs           swaps
1606   3149   5147  6414  6816  7275       ide          sys
180    31507  5203  6418  6991  7282       interrupts   sysrq-trigger
181    3189   5206  6419  6993  7298       iomem        sysvipc
182    3193   5228  6420  6996  7319       ioports      timer_list
18898  3246   5272  6421  7157  7330       irq          timer_stats
19799  3248   5291  6422  7163  7345       kallsyms     tty
19803  3253   5294  6423  7164  7513       kcore        uptime
19804  3372   5356  6424  7171  7525       key-users    version
1987   4      5370  6425  7175  7529       kmsg         version_signature
1989   42     5379  6426  7188  9964       loadavg      vmcore
2      45     5380  6430  7189  acpi       locks        vmnet
20845  4542   5412  6450  7191  asound     meminfo      vmstat
221    46     5414  6551  7192  buddyinfo  misc         zoneinfo
2338   4704   5416  6568  7199  bus        modules
```

Давайте обратим внимание на свойства файлов из директории `/proc`. При рассмотрении даты и времени изменения данных файлов можно отметить, что эти параметры соответствуют текущим значениями даты и времени, из чего можно сделать вывод, что содержимое данных файлов постоянно обновляется (для предоставления доступа к актуальному содержимому используемых ядром ОС структур данных).

```sh
paul@RHELv4u4:~$ date
Пн янв 29 18:06:32 EST 2007
paul@RHELv4u4:~$ ls -al /proc/cpuinfo 
-r--r--r--  1 root root 0 ноя 29 18:06 /proc/cpuinfo
paul@RHELv4u4:~$ 
paul@RHELv4u4:~$  ...через некоторое время...
paul@RHELv4u4:~$ 
paul@RHELv4u4:~$ date
Пн янв 29 18:10:00 EST 2007
paul@RHELv4u4:~$ ls -al /proc/cpuinfo 
-r--r--r--  1 root root 0 ноя 29 18:10 /proc/cpuinfo
```

Размер большинства файлов из директории `/proc` равен 0 байт, но при этом файлы из данной директории содержат данные, а иногда большие объемы данных. Вы можете ознакомиться с этими данными, использовав команду `cat` по отношению к таким файлам, как файл `/proc/cpuinfo`, который содержит информацию о центральном процессоре.

```sh
paul@RHELv4u4:~$ file /proc/cpuinfo 
/proc/cpuinfo: empty
paul@RHELv4u4:~$ cat /proc/cpuinfo 
processor       : 0
vendor_id       : AuthenticAMD
cpu family      : 15
model           : 43
model name      : AMD Athlon(tm) 64 X2 Dual Core Processor 4600+
stepping        : 1
cpu MHz         : 2398.628
cache size      : 512 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 1
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic mtrr pge...
bogomips        : 4803.54
```

Для сравнения ниже приведено содержимое файла `/proc/cpuinfo` системы Sun Sunblade 1000...

```sh
paul@pasha:~$ cat /proc/cpuinfo
cpu : TI UltraSparc III (Cheetah)
fpu : UltraSparc III integrated FPU
promlib : Version 3 Revision 2
prom : 4.2.2
type : sun4u
ncpus probed : 2
ncpus active : 2
Cpu0Bogo : 498.68
Cpu0ClkTck : 000000002cb41780
Cpu1Bogo : 498.68
Cpu1ClkTck : 000000002cb41780
MMU Type : Cheetah
State:
CPU0: online
CPU1: online 
```

Большая часть файлов из директории `/proc` предназначена исключительно для чтения, причем для чтения некоторых из них требуются привилегии пользователя root; в некоторые файлы могут записываться данные, причем в директории `/proc/sys` таких файлов большинство. Давайте поговорим о некоторых файлах из директории `/proc`.

#### Файл `/proc/interrupts`

В системе архитектуры x86 в файле `/proc/interrupts` содержится информация о запросах прерываний.

```sh
paul@RHELv4u4:~$ cat /proc/interrupts 
           CPU0       
  0:   13876877    IO-APIC-edge  timer
  1:         15    IO-APIC-edge  i8042
  8:          1    IO-APIC-edge  rtc
  9:          0   IO-APIC-level  acpi
 12:         67    IO-APIC-edge  i8042
 14:        128    IO-APIC-edge  ide0
 15:     124320    IO-APIC-edge  ide1
169:     111993   IO-APIC-level  ioc0
177:       2428   IO-APIC-level  eth0
NMI:          0 
LOC:   13878037 
ERR:          0
MIS:          0
```

При использовании машины с двумя центральными процессорами данный файл выглядит следующим образом.

```sh
paul@laika:~$ cat /proc/interrupts 
          CPU0      CPU1       
  0:    860013        0  IO-APIC-edge     timer
  1:      4533        0  IO-APIC-edge     i8042
  7:         0        0  IO-APIC-edge     parport0
  8:   6588227        0  IO-APIC-edge     rtc
 10:      2314        0  IO-APIC-fasteoi  acpi
 12:       133        0  IO-APIC-edge     i8042
 14:         0        0  IO-APIC-edge     libata
 15:     72269        0  IO-APIC-edge     libata
 18:         1        0  IO-APIC-fasteoi  yenta
 19:    115036        0  IO-APIC-fasteoi  eth0
 20:    126871        0  IO-APIC-fasteoi  libata, ohci1394
 21:     30204        0  IO-APIC-fasteoi  ehci_hcd:usb1, uhci_hcd:usb2
 22:      1334        0  IO-APIC-fasteoi  saa7133[0], saa7133[0]
 24:    234739        0  IO-APIC-fasteoi  nvidia
NMI:        72       42 
LOC:    860000   859994 
ERR:         0
```

#### Файл `/proc/kcore`

Физическая память представлена файлом `/proc/kcore`. Не пытайтесь использовать команду cat по отношению к этому файлу; вместо этого при необходимости исследования содержимого оперативной памяти используйте отладчик. Размер файла `/proc/kcore` совпадает с объемом вашей оперативной памяти плюс четыре байта.

```sh
paul@laika:~$ ls -lh /proc/kcore 
-r-------- 1 root root 2.0G 2007-01-30 08:57 /proc/kcore
paul@laika:~$
```

#### Директория `/sys` для работы с системой горячего подключения устройств ядра Linux 2.6

Директория `/sys` была создана в процессе разработки версии 2.6 ядра Linux. С момента выпуска версии 2.6 ядро Linux использует файловую систему `sysfs` для реализации механизма горячего подключения устройств, использующих шины `usb` и `IEEE 1394` (FireWire). Обратитесь к страницам руководств `udev(8)` (данная подсистема пришла на смену подсистеме `devfs`) и `hotplug(8)` для получения дополнительной информации (или посетите [ресурс](http://linux-hotplug.sourceforge.net/)).

По существу, директория `/sys` содержит файлы с информацией об используемом аппаратном обеспечении.

### Директория системных ресурсов Unix `/usr`

Несмотря на то, что имя директории `/usr` напоминает слово `user` (пользователь), не следует забывать о том, что на самом деле оно расшифровывается как `Unix System Resources` (директория системных ресурсов Unix). Иерархия поддиректорий директории `/usr` должна содержать разделяемые данные приложений, доступные только для чтения. Некоторые системные администраторы осуществляют монтирование файловой системы `/usr` в режиме только для чтения. В этом случае данная директория должна быть расположена на отдельном разделе жесткого диска или на разделяемом ресурсе NFS.

#### Директория `/usr/bin`

Директория `/usr/bin` содержит множество реализаций команд.

```sh
paul@deb508:~$ ls /usr/bin | wc -l
1395
```

(В системе Solaris директория `/bin` является символьной ссылкой на директорию `/usr/bin`.)

#### Директория `/usr/include`

Директория `/usr/include` содержит общедоступные заголовочные файлы для языка программирования C.

```sh
paul@ubu1010:~$ ls /usr/include/
aalib.h        expat_config.h      math.h           search.h
af_vfs.h       expat_external.h    mcheck.h         semaphore.h
aio.h          expat.h             memory.h         setjmp.h
AL             fcntl.h             menu.h           sgtty.h
aliases.h      features.h          mntent.h         shadow.h
...
```

#### Директория `/usr/lib`

Директория `/usr/lib` содержит разделяемые библиотеки, которые не используются непосредственно пользователями или сценариями.

```sh
paul@deb508:~$ ls /usr/lib | head -7
4Suite
ao
apt
arj
aspell
avahi
bonobo
```

#### Директория `/usr/local`

Директория `/usr/local` может использоваться системным администратором для локальной установки программного обеспечения.

```sh
paul@deb508:~$ ls /usr/local/
bin  etc  games  include  lib  man  sbin  share  src
paul@deb508:~$ du -sh /usr/local/
128K    /usr/local/
```

#### Директория `/usr/share`

Директория `/usr/share` содержит независимые от архитектуры данные. Как вы можете заметить, данная директория имеет значительный размер.

```sh
paul@deb508:~$ ls /usr/share/ | wc -l
263
paul@deb508:~$ du -sh /usr/share/
1.3G    /usr/share/
```

Обычно данная директория содержит поддиректорию `/usr/share/man`, предназначенную для хранения файлов страниц руководств.

```sh
paul@deb508:~$ ls /usr/share/man
cs  fr            hu            it.UTF-8  man2  man6  pl.ISO8859-2  sv
de  fr.ISO8859-1  id            ja        man3  man7  pl.UTF-8      tr
es  fr.UTF-8      it            ko        man4  man8  pt_BR         zh_CN
fi  gl            it.ISO8859-1  man1      man5  pl    ru            zh_TW
```

Также данная директория содержит поддиректорию `/usr/share/games`, предназначенную для хранения всех статических данных игр (таким образом, в данной директории не могут находиться файлы со списками рекордов или журналами игрового процесса).

```sh
paul@ubu1010:~$ ls /usr/share/games/
openttd  wesnoth
```

#### Директория `/usr/src`

Директория `/usr/src` является рекомендуемой директорией для хранения файлов исходного кода ядра ОС.

```sh
paul@deb508:~$ ls -l /usr/src/
итого 12
drwxr-xr-x  4 root root 4096 2011-02-01 14:43 linux-headers-2.6.26-2-686
drwxr-xr-x 18 root root 4096 2011-02-01 14:43 linux-headers-2.6.26-2-common
drwxr-xr-x  3 root root 4096 2009-10-28 16:01 linux-kbuild-2.6.26
```

### Директория для изменяемых данных `/var`

Файлы заранее неизвестного размера, такие, как файлы журналов, файлы кэша и файлы очереди печати должны сохраняться в директории `/var`.

#### Директория `/var/log`

Директория `/var/log` выполняет функции центрального хранилища всех файлов журналов.

```sh
[paul@RHEL4b ~]$ ls /var/log
acpid           cron.2    maillog.2   quagga           secure.4
amanda          cron.3    maillog.3   radius           spooler
anaconda.log    cron.4    maillog.4   rpmpkgs          spooler.1
anaconda.syslog cups      mailman     rpmpkgs.1        spooler.2
anaconda.xlog   dmesg     messages    rpmpkgs.2        spooler.3
audit           exim      messages.1  rpmpkgs.3        spooler.4
boot.log        gdm       messages.2  rpmpkgs.4        squid
boot.log.1      httpd     messages.3  sa               uucp
boot.log.2      iiim      messages.4  samba            vbox
boot.log.3      iptraf    mysqld.log  scrollkeeper.log vmware-tools-guestd
boot.log.4      lastlog   news        secure           wtmp
canna           mail      pgsql       secure.1         wtmp.1
cron            maillog   ppp         secure.2         Xorg.0.log
cron.1          maillog.1 prelink.log secure.3         Xorg.0.log.old
```

#### Файл `/var/log/messages`

Стандартным файлом, к которому следует обратиться в первую очередь при диагностике дистрибутива от компании Red Hat (и производных дистрибутивов), является файл `/var/log/messages`. По умолчанию данный файл должен содержать информацию о событиях, которые происходят в рамках системы. Файл, выполняющий аналогичные функции в дистрибутивах Debian и Ubuntu, носит имя `/var/log/syslog`.

```sh
[root@RHEL4b ~]# tail /var/log/messages
Jul 30 05:13:56 anacron: anacron startup succeeded
Jul 30 05:13:56 atd: atd startup succeeded
Jul 30 05:13:57 messagebus: messagebus startup succeeded
Jul 30 05:13:57 cups-config-daemon: cups-config-daemon startup succeeded
Jul 30 05:13:58 haldaemon: haldaemon startup succeeded
Jul 30 05:14:00 fstab-sync[3560]: removed all generated mount points
Jul 30 05:14:01 fstab-sync[3628]: added mount point /media/cdrom for...
Jul 30 05:14:01 fstab-sync[3646]: added mount point /media/floppy for...
Jul 30 05:16:46 sshd(pam_unix)[3662]: session opened for user paul by... 
Jul 30 06:06:37 su(pam_unix)[3904]: session opened for user root by paul
```

#### Директория `/var/cache`

Директория `/var/cache` может содержать кэшированные данные некоторых приложений.

```sh
paul@ubu1010:~$ ls /var/cache/
apt      dictionaries-common    gdm       man        software-center
binfmts  flashplugin-installer  hald      pm-utils
cups     fontconfig             jockey    pppconfig
debconf  fonts                  ldconfig  samba
```

#### Директория `/var/spool`

Директория `/var/spool` обычно содержит поддиректории для хранения файлов с сообщениями электронной почты и данными задач cron, причем она также может быть родительской директорией для других файлов очередей (например, файлов очередей печати).

#### Директория `/var/lib`

Директория `/var/lib` содержит файлы с данными состояния приложений.

Дистрибутив Red Hat Enterprise Linux, к примеру, хранит файлы, относящиеся к менеджеру пакетов `rpm`, в поддиректории `/var/lib/rpm/`.

#### Другие директории `/var/...`

Директория `/var` также содержит файлы с идентификаторами процессов в поддиректории `/var/run` (которая в недалеком будущем будет заменена на директорию /run), временные файлы, которые не должны удаляться при перезагрузке, в поддиректории `/var/tmp`, а также файлы блокировок в поддиректории `/var/lock`. Далее в данной книге будут приведены дополнительные примеры использования директории `/var` для хранения данных.

---
[Содержание](#содержание)
